# Persistence란?
 정의: Entity가 영구적으로 저장될수 있도록 제공해주는 환경을 의미

# EntityFactory 와 EntityManager
 EntityFactory와 EntityManager는 Jpa개념을 이해하기에 기초가되는 개념이다.
EntityFactory는 일반적으로 DB 연결당 하나만 생성된다. 이유는 생성 비용이 크기때문
이제 Factory에서 필요시 EntityManager를 생성하여 객체를 담아 DB와 연결할 수 있게된다.

# Entity 



# 영속성 컨텍스트

정의: 엔티티를 영구 저장하는 환경

엔티티의 생명주기

- 비영속 
영속컨텍스트를 사용하기 전 객체
- 영속 (persist / find)
- 비영속 

객체를 컨텍스트에 넣어진 상태
- 아직 DB에 저장되지 않은상태
- 준영속 (detach / clear)
- 엔티티를 영속성컨텍스트에서 제거
- 영속성 컨테스트가 관리하지 않는 상태
- 삭제 (remove)

이점

- 1차 캐시
- 동일성 보장
- 변경감지 (스냅샷)
- 지연로딩

### 플러시

영속성 컨텍스트의 변경내용(쿼리) 을 데이터 베이스에 반영

플러시 발생

- 변경 감지
- 수정된 엔티티 쓰기 지연 SQL 저장소에 등록
- 쓰기지연 SQL 저장소의 쿼리를 데이터 베이스에 전송

```jsx
em.flush(); // comit까지 기다리지 않고 쿼리가 바로 DB에 반영 
```

주의! ‘플러시’는 영속성 컨테스트를 비우는 것이 아니라 변경내용을 데이터 베이스에 동기화

Q. 영속성 컨텍스트가 왜 필요한가?

영속성 컨텍스트는 엔티티를 영구저장하기위한 환경을 제공 영속성 컨텍스트가 없다면 직접 DB에 접근해서 변경을 해야하는데 이는 성능상 불필요한 문제가 발생할 수 있다.


# 궁금증
### JPA 성능문제

connect pool

영속성 컨텍스트

매니저 팩토리