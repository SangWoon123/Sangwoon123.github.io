---
published: true
layout: single
title:  "JPA í”„ë¡ì‹œ - ê°€ìƒ í”„ë¡ì‹œ íŒ¨í„´ ì´í•´"
toc: true
toc_sticky: true
toc_label: "    "

categories: ['íŒ¨í„´']
#tags: ['ë¸”ë¡œê·¸', 'jekyll', 'github', 'github.io']
---

> # í”„ë¡ì‹œ

![í”„ë¡ì‹œ ê°ì²´ ìƒì„±.png](/assets/images/í”„ë¡ì‹œ ê°ì²´ ìƒì„±.png) 

í”„ë¡ì‹œëŠ” DBì¿¼ë¦¬ ìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•œ ê°œë…

ProxyëŠ” ì‹¤ì œ ì—”í‹°í‹°ë¥¼ ê°€ì ¸ì™€ì„œ ëŒ€ì²´ ë˜ëŠ”ê²ƒì´ ì•„ë‹ˆë‹¤

â€˜ì—”í‹°í‹°ë¥¼ ì°¸ì¡°â€™ í•œë‹¤ëŠ” í‘œí˜„ì´ ë§ë‹¤

> # í”„ë¡ì‹œ ê°ì²´ ì„¤ëª…

![](https://www.google.com/url?sa=i&url=https%3A%2F%2Fnew-be.tistory.com%2F15&psig=AOvVaw1_NMX1cFsCI1rDUWQ5za_r&ust=1683120879630000&source=images&cd=vfe&ved=0CBEQjRxqFwoTCLDt9ILg1v4CFQAAAAAdAAAAABAE)

### ê°€ìƒ í”„ë¡ì‹œ íŒ¨í„´

í”„ë¡ì‹œ íŒ¨í„´ìœ¼ë¡œ ê¸°ë³¸í˜•, ê°€ìƒ, ë³´í˜¸, ë¡œê¹…, ì›ê²©, ìºì‹± ê³¼ ê°™ì´ ë‹¤ì–‘í•œ íŒ¨í„´ì´ ì¡´ì¬í•œë‹¤. 

JPAì—ì„œëŠ”  **ì›ë³¸ ê°ì²´ ìƒì„±ì—ì„œ ì†Œëª¨ë˜ëŠ” ë¦¬ì†ŒìŠ¤ ë¶€ë‹´ì„ ì¤„ì´ê³ ì** 

ì‹¤ì œ ê°ì²´ë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë§Œ í•˜ëŠ” í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” â€˜ê°€ìƒ í”„ë¡ì‹œâ€™íŒ¨í„´ì„ ì‚¬ìš©í•œë‹¤.

1. í”„ë¡ì‹œ íŒ¨í„´ ì •ì˜
- ë©”ì¸ ë¡œì§ì˜ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì¸í„°í˜ì´ìŠ¤ë¡œ ì •ì˜í•œë‹¤.
    
    ```java
    public interface Image {
        void display();
    }
    ```
    

1. í”„ë¡ì‹œ ê°ì²´ ìƒì„±
- ì‹¤ì œ ê°ì²´ RealImageë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  ì°¸ì¡°ë¥¼ í•œë‹¤ ì‹¤ì œ ê°ì²´ê°€ í•„ìš”í•œ ì‹œì ì¸ display() ë©”ì„œë“œê°€ ìˆ˜í–‰í•  ë•Œ ì‹¤ì œ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  displayë¥¼ í˜¸ì¶œí•œë‹¤.
    
    ```java
    public class ProxyImage implements Image{
    
        private RealImage realImage;
        private String fileName;
    
        public ProxyImage(String fileName){
            this.fileName=fileName;
        }
    
        @Override
        public void display(){
            if (realImage==null){  // ì‹¤ì œ ê°ì²´ê°€ í•„ìš”í•œ ì‹œì 
                realImage=new RealImage(fileName);
            }
            realImage.display();
        }
    ```
    

1. ì‹¤ì œ ê°ì²´
    
    ```java
    public class RealImage implements Image {
    
        private String fileName;
    
        public RealImage(String fileName){
            this.fileName = fileName;
            loadFromDisk(fileName);
        }
    
        @Override
        public void display() {
            System.out.println("Displaying " + fileName);
        }
    
        private void loadFromDisk(String fileName){
            System.out.println("Loading " + fileName);
        }
    }
    ```
    

1. ë©”ì¸ ì‹¤í–‰
    
    ```java
    public static void main(String[] args) {
            Image image = new ProxyImage("test.png");
    				// ì‹¤ì œ ì´ë¯¸ì§€ ê°ì²´ê°€ í•„ìš”í•œ ì‹œì ì—ì„œ ì‹¤ì œ ì´ë¯¸ì§€ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  display() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
    				image.display();
        }
    ```
    

ì´ì œ Image ì¸ìŠ¤í„´ìŠ¤ë¡œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•¨ìœ¼ë¡œì¨ í•„ìš” ì´ì „ì—” ê°€ë§Œíˆ ìˆë‹¤ê°€ ì´ë¯¸ì§€ê°€ í•„ìš”í•  ë•Œ 

ì¦‰, ìƒì„± í•  ì‹œì ì—ì„œ ì´ë¯¸ì§€ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.

ì´ì™€ ê°™ì´ JPAì—ì„  DB ì¿¼ë¦¬ë¡œ ì¸í•œ ë¬´ë¶„ë³„í•œ ì ‘ê·¼ì„ í”„ë¡ì‹œ íŒ¨í„´ì„ ì ìš©í•˜ì—¬ ì‹¤ì œ ê°ì²´ê°€ í•„ìš”í•œ ì‹œì ì— ìƒì„±í•˜ë„ë¡ í•œë‹¤.

ì´ëŠ” FetchType.LAZYë¥¼ ì‚¬ìš©í•˜ì—¬ ì—”í‹°í‹°ë¥¼ ê°€ì ¸ì˜¬ë•Œ í”„ë¡ì‹œ ê°ì²´ë¡œ ë°˜í™˜í•˜ê²Œ ëœë‹¤. ì´ë¡œì„œ ì§€ì—°ë¡œë”©ì„ í•  ìˆ˜ ìˆê²Œëœë‹¤.

--- 
ë” ìì„¸í•œ ì„¤ëª…ì€ [ğŸ’  í”„ë¡ì‹œ(Proxy) íŒ¨í„´ - ì™„ë²½ ë§ˆìŠ¤í„°í•˜ê¸°](https://inpa.tistory.com/entry/GOF-ğŸ’ -í”„ë¡ì‹œProxy-íŒ¨í„´-ì œëŒ€ë¡œ-ë°°ì›Œë³´ì) ì°¸ì¡°


<!-- getReference ì‚¬ìš©ì‹œ ì¿¼ë¦¬ë¬¸ì„ ì‚¬ìš©í•˜ì§€ì•ŠìŒ

- ê°€ì§œ ì—”í‹°í‹°ê°ì²´ë¥¼ ë°˜í™˜í•´ì¤Œ

í”„ë¡ì‹œ íŠ¹ì§•

- ì‹¤ì œ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì§
- ì‹¤ì œ í´ë˜ìŠ¤ì™€ ê²‰ ëª¨ì–‘ì´ ê°™ë‹¤
- ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œ ì§„ì§œ ê°ì²´ì¸ì§€ í”„ë¡ì‹œ ê°ì²´ì¸ì§€ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì‚¬ìš©ê°€ëŠ¥

í”„ë¡ì‹œ ê°ì²´ëŠ” í˜¸ì¶œì‹œ ì§„ì§œ ê°ì²´ì˜ ë©”ì†Œë“œë¥¼ ê°€ì ¸ì™€ì„œ ë°˜í™˜í•´ì¤€ë‹¤.

í”„ë¡ì‹œ ê°ì²´ëŠ” ì²˜ìŒ ì‚¬ìš©í• ë•Œ í•œë²ˆë§Œ ì´ˆê¸°í™”

í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™” í•  ë•Œ, í”„ë¡ì‹œ ê°ì²´ê°€ ì‹¤ì œ ì—”í‹°í‹°ë¡œ ë°”ë€ŒëŠ” ê²ƒì€ ì•„ë‹˜

### í”„ë¡ì‹œë¥¼ getReferenceë¡œ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì§€ë§Œ,

ì‹¤ì „ì—ì„  FetchType.Lazyë¡œ êµ¬í˜„

FetchType.LAZY ì€  ì§€ì—°ë¡œë”© 

FetchType.EAGER ì€ ì¡°ì¸í•˜ì—¬ ì¦‰ì‹œë¡œë”© 

### í”„ë¡ì‹œì™€ ì¦‰ì‹œë¡œë”© ì£¼ì˜

- ê°€ê¸‰ì  ì§€ì—° ë¡œë”©ë§Œ ì‚¬ìš©(íŠ¹íˆ ì‹¤ë¬´ì—ì„œ)
- ì¦‰ì‹œ ë¡œë”©ì„ ì ìš©í•˜ë©´ ì˜ˆìƒí•˜ì§€ ëª»í•œ SQLì´ ë°œìƒ
- ì¦‰ì‹œ ë¡œë”©ì€ JPQLì—ì„œ N+1ë¬¸ì œ ë°œìƒ
- @ManyToOne, @OneToOne ì€ ê¸°ë³¸ì´ ì¦‰ì‹œë¡œë”© â†’ LAZYë¡œ ì„¤ì •
- @OneToMany, @ManyTonManyëŠ” ê¸°ë³¸ì´ ì§€ì—°ë¡œë”©

### ì˜ì†ì„± ì „ì´: CASCADE

- íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ê³  ì‹¶ì„ë•Œ

CASCADE ì˜ ì¢…ë¥˜

- ALL: ëª¨ë‘ ì ìš©
- PERSIST: ì˜ì†
- REMOVE: ì‚­ì œ
- MERGE: ë³‘í•©
- REFRESH: REFRESH
- DETACH: DETACH

### ì£¼ì˜

ë‹¨ì¼ ì—”í‹°í‹°ì— ì¢…ì†ëœ ê°ì²´ë§Œ CASCADE ì‚¬ìš©ê°€ëŠ¥

parent child ë¼ì´í”„ ì‚¬ì´í´ì´ ë™ì¼ í•  ë•Œ

ì†Œìœ ìê°€ í•˜ë‚˜ì¼ ë•Œ

### ê³ ì•„ê°ì²´

ì •ì˜: ë¶€ëª¨ ì—”í‹°í‹°ì™€ ì—°ê´€ê´€ê»˜ê°€ ëŠì–´ì§„ ìì‹ ì—”í‹°í‹°ë¥¼ ìë™ìœ¼ë¡œ ì‚­ì œ

orphanRemoval=true

ì£¼ì˜

- ì°¸ì¡°í•˜ëŠ” ê³³ì´ í•˜ë‚˜ì¼ ë•Œ ì‚¬ìš©í•´ì•¼í•¨
- íŠ¹ì • ì—”í‹°í‹°ê°€ ê°œì¸ ì†Œìœ  í• ë•Œ ì‚¬ìš© -->
